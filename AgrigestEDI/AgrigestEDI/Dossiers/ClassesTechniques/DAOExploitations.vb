Namespace Dossiers.ClassesTechniques
    Public Class DAOExploitations

        Private _ConnString As String = Nothing
        Private _ExploitationsTA As DataSetAgrigestTableAdapters.ExploitationsTableAdapter

#Region "Propriétés"
        Public Property ConnString() As String
            Get
                Return Me._ConnString
            End Get
            Set(ByVal value As String)
                Me._ConnString = value
            End Set
        End Property

        Public Property ExploitationsTA() As DataSetAgrigestTableAdapters.ExploitationsTableAdapter
            Get
                Return Me._ExploitationsTA
            End Get
            Set(ByVal value As DataSetAgrigestTableAdapters.ExploitationsTableAdapter)
                Me._ExploitationsTA = value
            End Set
        End Property
#End Region

#Region "Constructeurs"
        Public Sub New(ByVal connString As String)
            Me._ConnString = connString
            Me._ExploitationsTA = New DataSetAgrigestTableAdapters.ExploitationsTableAdapter

            Me.ExploitationsTA.Connection.ConnectionString = Me.ConnString
        End Sub
#End Region

#Region "Méthodes diverses"
        Public Function GetExploitation(ByVal EExpl As String) As Dossiers.ClassesMetier.Exploitations
            Dim expl As Dossiers.ClassesMetier.Exploitations = Nothing

            Dim exploitationsDT As DataSetAgrigest.ExploitationsDataTable = Me.ExploitationsTA.GetDataByEExpl(EExpl)

            If (exploitationsDT.Rows.Count > 0) Then
                expl = New Dossiers.ClassesMetier.Exploitations

                Dim exploitationsDR As DataSetAgrigest.ExploitationsRow = CType(exploitationsDT.Rows(0), DataSetAgrigest.ExploitationsRow)

                expl.EExpl = exploitationsDR.EExpl

                If Not (exploitationsDR.IsENom1Null) Then
                    expl.ENom1 = exploitationsDR.ENom1
                Else
                    expl.ENom1 = String.Empty
                End If

                If Not (exploitationsDR.IsENom2Null) Then
                    expl.ENom2 = exploitationsDR.ENom2
                Else
                    expl.ENom2 = String.Empty
                End If

                If Not (exploitationsDR.IsETypeNull) Then
                    expl.EType = exploitationsDR.EType
                Else
                    expl.EType = String.Empty
                End If
            End If

            Return expl
        End Function
#End Region

    End Class
End Namespace
